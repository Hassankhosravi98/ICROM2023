clc



A(1)=- Iyy3^2*Izz3*dq1^2*cos(q2)*sin(q2) + Izz2*Izz3^2*dq1^2*cos(q2)*sin(q2) + (Iyy3^2*Izz3*dq1*dq2*cos(q2))/2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2))/2 - (Izz2*Izz3^2*dq1*dq2*cos(q2))/2 + (Izz2*Izz3^2*dq1*dq3*cos(q2))/2 + Iyy3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2) + Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + Ixx3*Izz3^2*dq1^2*cos(q2)*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1^2*cos(q2)*sin(q2)*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2 - (Ixx3*Izz3^2*dq1*dq2*cos(q2)*sin(q3)^2)/2 - (Ixx3^2*Izz3*dq1*dq2*cos(q2)*sin(q3)^2)/2 + (Ixx3*Izz3^2*dq1*dq3*cos(q2)*sin(q3)^2)/2 + (Ixx3^2*Izz3*dq1*dq3*cos(q2)*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q3)^2)/2 - Ixx3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx3^2*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3)^3 - Iyy3^2*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q3)^2 - Ixx2*Izz2*Izz3*dq1^2*cos(q2)*sin(q2) + Iyy2*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)  - Iyy3*Izz2*Izz3*dq1^2*cos(q2)*sin(q2) + Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2) - (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 - (Iyy3^2*Izz3*dq2*dq3*cos(q2)*sin(q2))/2 - Izz2*Izz3^2*dq1*dq2*cos(q2)*sin(q2) - (Izz2*Izz3^2*dq1*dq3*cos(q2)*sin(q2))/2 + (Izz2*Izz3^2*dq2*dq3*cos(q2)*sin(q2))/2 - (Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2))/2 + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2))/2 - (Ixx3*Izz2*Izz3*dq1*dq2*cos(q2))/2 + (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2))/2 + (Iyy3*Izz2*Izz3*dq1*dq2*cos(q2))/2 - (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2))/2 - (Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 + (Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 - (Ixx3*Izz3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 - (Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)+ (Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) - Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) + Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2) - (Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2 + Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 - Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2 - Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 + Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2 - Ixx3*Izz3^2*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 - (Ixx3*Izz3^2*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Ixx3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Ixx3*Izz3^2*dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Ixx3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - Ixx3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3)^3 - Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - Iyy3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3)^3 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q3)^2 - Ixx3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Iyy3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3)^3 + 2*Ixx3*Iyy3*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q3)^2 - Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) - Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) + Iyy3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3) + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2))/2 + Ixx2*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2) - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2) + (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + (Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)*sin(q2))/2  + Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2) - (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 - (Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)*sin(q2))/2 - Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Izz2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Izz2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + Iyy3*Izz2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2) + Iyy3*Izz2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)*sin(q3)^2 - Iyy2*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3)^3 + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Ixx3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Ixx3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3) - Ixx3*Izz2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3) + Iyy3*Izz2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3) - Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) + Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2) - Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) + Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) - Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) + Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2) - 4*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2  + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3);

%%

A(2)=- Ixx2^2*Izz3*dq1*dq2*cos(q2)^3*sin(q2) + Ixx2*Iyy2*Izz3*dq1*dq2*cos(q2)^3*sin(q2) - Ixx2*Iyy2*Izz3*dq1*dq2*cos(q2)*sin(q2)^3  + Ixx2*Izz3^2*dq1*dq2*cos(q2)^3*sin(q2) + (Ixx2*Izz3^2*dq1*dq2*cos(q2)^3)/2 + (dq3*Ixx2*Izz3^2*dq2*cos(q2)^3)/2 - Izz1*Ixx2*Izz3*dq1*dq2*cos(q2)*sin(q2) + Ixx3^2*Izz3*dq1^2*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Ixx3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^4*sin(q2) + Ixx3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^4 - (Ixx3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2)/2 - 2*Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) + (Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 - dq3*Ixx3^2*Izz3*dq1*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 - dq3*Ixx3^2*Izz3*dq1*cos(q2)^3*cos(q3)^2*sin(q3)^2 + dq3*Ixx3^2*Izz3*dq1*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + dq3*Ixx3^2*Izz3*dq1*cos(q2)^2*cos(q3)^3*sin(q3) - (dq3*Ixx3^2*Izz3*dq1*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (dq3*Ixx3^2*Izz3*dq1*cos(q2)^2*cos(q3)*sin(q3))/2 + Ixx3^2*Izz3*dq2^2*cos(q2)^2*cos(q3)^3*sin(q3) - dq3*Ixx3^2*Izz3*dq2*cos(q2)^3*cos(q3)^4 + (dq3*Ixx3^2*Izz3*dq2*cos(q2)^3*cos(q3)^2)/2 + dq3*Ixx3^2*Izz3*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - dq3*Ixx3^2*Izz3*dq2*cos(q2)^2*cos(q3)^3*sin(q3) - (dq3*Ixx3^2*Izz3*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + dq3*Ixx3^2*Izz3*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^3*cos(q3)^2*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^4*sin(q2) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^4 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2) + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q3)^2 + (Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2)/2 - (Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*sin(q3)^2)/2 + 3*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3) + 2*dq3*Ixx3*Iyy3*Izz3*dq1*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*dq3*Ixx3*Iyy3*Izz3*dq1*cos(q2)^3*cos(q3)^2*sin(q3)^2 - 2*dq3*Ixx3*Iyy3*Izz3*dq1*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - 2*dq3*Ixx3*Iyy3*Izz3*dq1*cos(q2)^2*cos(q3)^3*sin(q3) + dq3*Ixx3*Iyy3*Izz3*dq1*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + dq3*Ixx3*Iyy3*Izz3*dq1*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq2^2*cos(q2)^2*cos(q3)^3*sin(q3) + Ixx3*Iyy3*Izz3*dq2^2*cos(q2)^2*cos(q3)*sin(q3)^3 + dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)^3*cos(q3)^4 - dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)^3*cos(q3)^2*sin(q3)^2 - (dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)^3*cos(q3)^2)/2 + (dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)^3*sin(q3)^2)/2 - 2*dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)^2*cos(q3)^3*sin(q3) + dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)^2*cos(q3)*sin(q3)^3 - 2*dq3*Ixx3*Iyy3*Izz3*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3*Izz3^2*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Izz3^2*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2) + (Ixx3*Izz3^2*dq1*dq2*cos(q2)^3*cos(q3)^2)/2 + Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + (Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 + (dq3*Ixx3*Izz3^2*dq1*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (dq3*Ixx3*Izz3^2*dq1*cos(q2)^2*cos(q3)*sin(q3))/2 + (dq3*Ixx3*Izz3^2*dq2*cos(q2)^3*cos(q3)^2)/2 - (dq3*Ixx3*Izz3^2*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - Izz1*Ixx3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) + Izz1*Ixx3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 - (Izz1*Ixx3*Izz3*dq1*dq2*cos(q2))/2 - Izz1*Ixx3*Izz3*dq1*dq2*cos(q3)*sin(q2)*sin(q3) + Izz1*Ixx3*Izz3*dq2^2*cos(q3)*sin(q3) - Izz1*dq3*Ixx3*Izz3*dq2*cos(q2)*cos(q3)^2 + (Izz1*dq3*Ixx3*Izz3*dq2*cos(q2))/2 - Izz1*dq3*Ixx3*Izz3*dq2*cos(q3)*sin(q3) + Iyy2^2*Izz3*dq1*dq2*cos(q2)*sin(q2)^3 + Iyy2*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)^3*sin(q2)*sin(q3)^2 - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^3 - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^3 + (Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^2)/2 + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q3)*sin(q2)^3*sin(q3) - Iyy2*Iyy3*Izz3*dq2^2*cos(q3)*sin(q2)^2*sin(q3) + dq3*Iyy2*Iyy3*Izz3*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - (dq3*Iyy2*Iyy3*Izz3*dq2*cos(q2)*sin(q2)^2)/2 + dq3*Iyy2*Iyy3*Izz3*dq2*cos(q3)*sin(q2)^2*sin(q3) + Iyy2*Izz3^2*dq1*dq2*cos(q2)*sin(q2)^3 + (Iyy2*Izz3^2*dq1*dq2*cos(q2)*sin(q2)^2)/2 + (dq3*Iyy2*Izz3^2*dq2*cos(q2)*sin(q2)^2)/2 + Izz1*Iyy2*Izz3*dq1*dq2*cos(q2)*sin(q2) + Iyy3^2*Izz3*dq1^2*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^3*sin(q2)*sin(q3)^2 + (Iyy3^2*Izz3*dq1*dq2*cos(q2)^3*sin(q3)^2)/2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + (Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 - dq3*Iyy3^2*Izz3*dq1*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 - dq3*Iyy3^2*Izz3*dq1*cos(q2)^3*cos(q3)^2*sin(q3)^2 + dq3*Iyy3^2*Izz3*dq1*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + dq3*Iyy3^2*Izz3*dq1*cos(q2)^2*cos(q3)^3*sin(q3) - (dq3*Iyy3^2*Izz3*dq1*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (dq3*Iyy3^2*Izz3*dq1*cos(q2)^2*cos(q3)*sin(q3))/2 - Iyy3^2*Izz3*dq2^2*cos(q2)^2*cos(q3)*sin(q3)^3 + dq3*Iyy3^2*Izz3*dq2*cos(q2)^3*cos(q3)^2*sin(q3)^2 - (dq3*Iyy3^2*Izz3*dq2*cos(q2)^3*sin(q3)^2)/2 + dq3*Iyy3^2*Izz3*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - (dq3*Iyy3^2*Izz3*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + dq3*Iyy3^2*Izz3*dq2*cos(q2)^2*cos(q3)*sin(q3)^3 + dq3*Iyy3^2*Izz3*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Izz1*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Izz1*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 - Izz1*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2) + (Izz1*Iyy3*Izz3*dq1*dq2*cos(q2))/2 + Izz1*Iyy3*Izz3*dq1*dq2*cos(q3)*sin(q2)*sin(q3) - Izz1*Iyy3*Izz3*dq2^2*cos(q3)*sin(q3) + Izz1*dq3*Iyy3*Izz3*dq2*cos(q2)*cos(q3)^2 - (Izz1*dq3*Iyy3*Izz3*dq2*cos(q2))/2 + Izz1*dq3*Iyy3*Izz3*dq2*cos(q3)*sin(q3) + Izz1*Izz3^2*dq1*dq2*cos(q2)*sin(q2) + (Izz1*Izz3^2*dq1*dq2*cos(q2))/2 + (Izz1*dq3*Izz3^2*dq2*cos(q2))/2;
 


%%
A(3)=Iyy3^2*Izz3*dq1^2*cos(q2)*sin(q2)^2  - Izz2*Izz3^2*dq1^2*cos(q2)*sin(q2)^2 + (Iyy3^3*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 + (Iyy3^3*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 - (Iyy3^3*dq1*dq3*cos(q2)^3*sin(q3)^4)/2 - (Iyy3^3*dq2*dq3*cos(q2)^3*sin(q3)^4)/2 + (Iyy3^2*Izz1*dq1*dq3*cos(q2))/2 + (Iyy3^2*Izz1*dq2*dq3*cos(q2))/2 + Ixx2*Izz2*Izz3*dq1^2*cos(q2)*sin(q2)^2 - Iyy2*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)^2 + Iyy3*Izz2*Izz3*dq1^2*cos(q2)*sin(q2)^2 - Iyy3^3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Iyy3^3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Iyy3^3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^5 - Iyy3^3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^5 - Iyy3^2*Izz1*dq1*dq3*cos(q2)*cos(q3)^2 - Iyy3^2*Izz1*dq2*dq3*cos(q2)*cos(q3)^2 + (Iyy2*Iyy3^2*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3^2*Izz1*dq1*dq3*cos(q2)*sin(q3)^2)/2 + (Iyy2*Iyy3^2*dq2*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3^2*Izz1*dq2*dq3*cos(q2)*sin(q3)^2)/2 + Ixx3^2*Izz1*dq2*dq3*cos(q3)*sin(q3)^3 - (Iyy3^2*Izz1*dq1*dq3*cos(q2)*sin(q3)^2)/2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)^2 - (Iyy3^2*Izz1*dq2*dq3*cos(q2)*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 + (Iyy3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 + Iyy3^2*Izz1*dq2*dq3*cos(q3)*sin(q3)^3 + Izz2*Izz3^2*dq1*dq2*cos(q2)*sin(q2)^2 + (Izz2*Izz3^2*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Izz2*Izz3^2*dq2*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^3)/2 - (Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^3)/2 - (Ixx2*Ixx3*Izz2*dq1*dq3*cos(q2)^3)/2 - (Ixx2*Ixx3*Izz2*dq2*dq3*cos(q2)^3)/2 + (Ixx2*Iyy3*Izz2*dq1*dq3*cos(q2)^3)/2 + (Ixx2*Iyy3*Izz2*dq2*dq3*cos(q2)^3)/2 + (Ixx2*Izz2*Izz3*dq1*dq3*cos(q2)^3)/2 - (Ixx2*Izz2*Izz3*dq2*dq3*cos(q2)^3)/2 - Iyy3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2 - Ixx3*Izz3^2*dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 - (3*Iyy3^3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 - (3*Iyy3^3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 + Iyy3^3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 + Iyy3^3*dq1*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 + Iyy3^3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3)^3 - Iyy3^3*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3)^3 + Iyy3^3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 + Iyy3^3*dq2*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 + (Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 + (Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^4 + Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^4 - Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^4 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^4 - (Ixx3^2*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 + Ixx3^2*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^4 + Ixx3^2*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^4 - (Ixx2*Ixx3^2*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Ixx2*Ixx3^2*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 - (Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*sin(q3)^4 - (Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*sin(q3)^4)/2 + Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*sin(q3)^4 - (Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*sin(q3)^4)/2 + (Iyy3^2*Izz2*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 + (Iyy3^2*Izz2*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2)^3*sin(q3)^4)/2 + (Iyy3^2*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^4)/2 - (Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2))/2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 - Iyy3^2*Izz1*dq2*dq3*cos(q3)*sin(q3) + (Izz2*Izz3^2*dq1*dq2*cos(q2)*sin(q2))/2 - (Izz2*Izz3^2*dq1*dq3*cos(q2)*sin(q2))/2 - (Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2))/2 - (Ixx3*Iyy3*Izz1*dq2*dq3*cos(q2))/2 - (Ixx3*Izz1*Izz2*dq1*dq3*cos(q2))/2 - (Ixx3*Izz1*Izz2*dq2*dq3*cos(q2))/2 + (Iyy3*Izz1*Izz3*dq1*dq3*cos(q2))/2 - (Iyy3*Izz1*Izz3*dq2*dq3*cos(q2))/2 + (Izz1*Izz2*Izz3*dq1*dq3*cos(q2))/2 - (Izz1*Izz2*Izz3*dq2*dq3*cos(q2))/2 + Iyy3^2*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)*cos(q3)^2 + Ixx3*Iyy3*Izz1*dq2*dq3*cos(q2)*cos(q3)^2 + Ixx3*Izz1*Izz2*dq1*dq3*cos(q2)*cos(q3)^2 + Ixx3*Izz1*Izz2*dq2*dq3*cos(q2)*cos(q3)^2 + (Ixx3*Izz3^2*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Ixx3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2)/2 - (Ixx3*Izz3^2*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - (Ixx3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - Iyy2*Iyy3^2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) + (Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2)/2- (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - Iyy3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - (Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Iyy2*Izz2*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Iyy2*Izz2*dq2*dq3*cos(q2)*sin(q2)^2)/2 + Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz1*dq2*dq3*cos(q2)*sin(q3)^2 - (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 - 2*Ixx3*Iyy3*Izz1*dq2*dq3*cos(q3)*sin(q3)^3 - Ixx2*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2)^2 + (Iyy2*Iyy3*Izz2*dq1*dq3*cos(q2)*sin(q2)^2)/2 + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^2 + (Ixx3*Izz1*Izz3*dq1*dq3*cos(q2)*sin(q3)^2)/2 - (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 + (Iyy2*Iyy3*Izz2*dq2*dq3*cos(q2)*sin(q2)^2)/2 + (Iyy2*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Izz1*Izz3*dq2*dq3*cos(q2)*sin(q3)^2)/2 - (Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 - (Iyy2*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 - Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2)^2 - (Iyy3*Izz1*Izz3*dq1*dq3*cos(q2)*sin(q3)^2)/2 + (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 + (Iyy3*Izz1*Izz3*dq2*dq3*cos(q2)*sin(q3)^2)/2 + (Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 + Ixx3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + Ixx3^2*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + Iyy3^2*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Izz2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3*Izz2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2+ Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 + Iyy2*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 + Ixx2*Ixx3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx2*Ixx3^2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx3*Iyy3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx3*Iyy3^2*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3*Iyy3^2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx3*Iyy3^2*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3) - Ixx3^2*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3) - 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^5 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^5 + 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^5 - Ixx3^2*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^5 - Iyy2*Iyy3^2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3^2*Izz1*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - Iyy2*Iyy3^2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Ixx3^2*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Ixx3^2*Izz1*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz2*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3^2*Izz2*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3) + Iyy3^2*Izz1*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3^2*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Iyy3^2*Izz1*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3^2*Izz2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Iyy3^2*Izz2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2 + Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2 + Ixx2*Ixx3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2 + Ixx2*Ixx3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2 - Ixx2*Iyy3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2 - Ixx2*Iyy3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2 + (Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 + (Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 - Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^4 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^4 + (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Iyy2*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Ixx3^2*Iyy2*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + Ixx3^2*Iyy2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx3*Izz3^2*dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 - (Iyy2*Iyy3^2*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + (Ixx3*Izz3^2*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Iyy2*Iyy3^2*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Ixx3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Ixx3*Izz3^2*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Ixx3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + Iyy2*Iyy3^2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3+ Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2- (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + Iyy3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^3*sin(q3)^2 + Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^3*sin(q3)^2  - (Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^3*sin(q3)^2)/2  - (Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^3*sin(q3)^4)/2 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^4)/2 + (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + Ixx3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + Iyy3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + (Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2))/2 - (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + Ixx3*Iyy3*Izz1*dq2*dq3*cos(q3)*sin(q3) + (Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2))/2 - (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + Ixx3*Izz1*Izz2*dq2*dq3*cos(q3)*sin(q3) - (Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2))/2 + (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2  + Ixx2*Ixx3^2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Ixx2*Ixx3^2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - (Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 + 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - (Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 - 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 - 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 - 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3)^3 + Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 + Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3)^3 + 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3)^3 - 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 - 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 - Ixx3^2*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3)^3 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 - Iyy3^2*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 - Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 + Ixx3*Iyy2*Izz2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - Iyy2*Iyy3*Izz2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) + Ixx3*Izz2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - Iyy3*Izz2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - 2*Ixx3*Iyy3*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + Iyy2*Iyy3^2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Ixx3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Ixx3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - 2*Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + 2*Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy2*Izz2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy2*Izz2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - 2*Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 + 2*Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - 2*Ixx3*Iyy3*Izz1*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3) - Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy2*Iyy3*Izz2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy2*Iyy3*Izz2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2 + Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2 - 2*Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 - (Iyy2*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + (Iyy2*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + Ixx3^2*Iyy2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Ixx3^2*Iyy2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx3^2*Iyy2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + Iyy2*Iyy3^2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - 2*Ixx3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Iyy2*Iyy3^2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 + Iyy2*Iyy3^2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)^2*sin(q3) + Ixx3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - 2*Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)^2*sin(q3) + Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 + Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - 2*Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - 2*Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 + Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Izz2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3*Izz2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + (Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + (Ixx3*Izz3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + (Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + (Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3) + Ixx2*Ixx3*Izz2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx2*Ixx3*Izz2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Ixx2*Iyy3*Izz2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx2*Iyy3*Izz2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3) - Ixx3*Izz1*Izz2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Ixx3*Iyy2*Izz2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Iyy2*Iyy3*Izz2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + 2*Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 - 2*Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + 4*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3);


%%

F_matrix=[0   , -dq1^2*cos(q2)*sin(q2)+ dq1*dq2*cos(q2)*sin(q2)+ dq1^2*cos(q2)*sin(q2)*sin(q3)^2-dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2-dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)    , dq1^2*cos(q2)*sin(q2) - (dq1*dq2*cos(q2))/2 + (dq1*dq3*cos(q2))/2 -dq1^2*cos(q2)*sin(q2)*sin(q3)^2 + (dq1*dq2*cos(q2)*sin(q3)^2)/2 - (dq1*dq3*cos(q2)*sin(q3)^2)/2 -dq1*dq2*cos(q2)*sin(q2) - (dq1*dq3*cos(q2)*sin(q2))/2 + (dq2*dq3*cos(q2)*sin(q2))/2  + (dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 + (dq2*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 + dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 + (dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - (dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 +dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)   , 0  ,   -dq1^2*cos(q2)*sin(q2)*sin(q3)^2  +dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 +dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)   ,   dq1^2*cos(q2)*sin(q2)*sin(q3)^2 - dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 -dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)   ,   +dq1^2*cos(q2)*sin(q2)-dq1*dq2*cos(q2)*sin(q2)
    0   , -dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) +dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2) -dq1*dq2*cos(q2)^3*cos(q3)^2 -dq1*dq2*cos(q2)^3*sin(q2)*sin(q3)^2 -dq1*dq2*cos(q2)^3*sin(q2) + (dq1*dq2*cos(q2)^3)/2 + 2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) -dq2^2*cos(q2)^2*cos(q3)*sin(q3)+ dq3*dq2*cos(q2)^3*cos(q3)^2 - (dq3*dq2*cos(q2)^3)/2 + dq3*dq2*cos(q2)^2*cos(q3)*sin(q3)  , +dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + dq1*dq2*cos(q2)^3*sin(q2)*sin(q3)^2 + (dq1*dq2*cos(q2)^3*sin(q3)^2)/2 -dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - (dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 - (dq3*dq1*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + (dq3*dq1*cos(q2)^2*cos(q3)*sin(q3))/2 + (dq3dq2*cos(q2)^3*sin(q3)^2)/2 + (dq3*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2   , 0  ,   dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - 2*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2) + dq1*dq2*cos(q2)^3*cos(q3)^2 - (dq1*dq2*cos(q2)^3)/2 - 2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + dq2^2*cos(q2)^2*cos(q3)*sin(q3) - dq3*dq2*cos(q2)^3*cos(q3)^2 + (dq3*dq2*cos(q2)^3)/2 -dq2*cos(q2)^2*cos(q3)*sin(q3)   ,   -dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2) +dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) -dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^3 +dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - (dq1*dq2*cos(q2)*sin(q2)^2)/2 -dq1*dq2*cos(q3)*sin(q2)^3*sin(q3) + dq2^2*cos(q3)*sin(q2)^2*sin(q3) - dq3*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 + (dq3*dq2*cos(q2)*sin(q2)^2)/2 - dq3*dq2*cos(q3)*sin(q2)^2*sin(q3)   ,   0
(dq1*dq3*cos(q2)^3)/2 +(dq2*dq3*cos(q2)^3)/2-dq1*dq3*cos(q2)^3*cos(q3)^2 -dq2*dq3*cos(q2)^3*cos(q3)^2- (dq1*dq3*cos(q2)^3*sin(q3)^2)/2 -(dq2*dq3*cos(q2)^3*sin(q3)^2)/2- dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) +dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)+dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 -dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3+dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2        ,+dq1^2*cos(q2)*sin(q2)^2+ (dq1*dq3*cos(q2)^3)/2 - (dq2*dq3*cos(q2)^3)/2- dq1*dq2*cos(q2)*sin(q2)^2-dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2- (dq1*dq3*cos(q2)^3*sin(q3)^2)/2+ (dq2*dq3*cos(q2)^3*sin(q3)^2)/2+dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 +dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)     , -dq1^2*cos(q2)*sin(q2)^2+ dq1*dq2*cos(q2)*sin(q2)^2 + (dq1*dq3*cos(q2)*sin(q2)^2)/2 - (dq2*dq3*cos(q2)*sin(q2)^2)/2 + dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 + (dq1*dq2*cos(q2)*sin(q2))/2 - (dq1*dq3*cos(q2)*sin(q2))/2 - (dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2)/2  + (dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2  -dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2  - (dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + (dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 -dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - (dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2  , + (dq1*dq3*cos(q2))/2 + (dq2*dq3*cos(q2))/2 -dq1*dq3*cos(q2)*cos(q3)^2 - dq2*dq3*cos(q2)*cos(q3)^2 - dq2*dq3*cos(q3)*sin(q3)+ dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)  ,   dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 + (dq1*dq3*cos(q2)^3*sin(q3)^2)/2- (dq2*dq3*cos(q2)^3*sin(q3)^2)/2 -dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 -dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3),    -dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 +dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 + (dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2- (dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 +dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)   ,   -dq1^2*cos(q2)*sin(q2)^2 +dq1*dq2*cos(q2)*sin(q2)^2 + (dq1*dq3*cos(q2)*sin(q2)^2)/2- (dq2*dq3*cos(q2)*sin(q2)^2)/2];

TETA=[Ixx2*Iyy3^2
     Ixx2*Iyy3*Izz3
     Iyy3*Izz3^2
     Iyy3*Izz1*Izz2
     Ixx2*Ixx3*Izz3
     Ixx3*Iyy2*Izz3
     Iyy2*Izz2*Izz3];

%%
 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Izz2*Izz3^2*dq1^2*cos(q2)*sin(q2) - Iyy3^2*Izz3*dq1^2*cos(q2)*sin(q2) + (Iyy3^2*Izz3*dq1*dq2*cos(q2))/2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2))/2 - (Izz2*Izz3^2*dq1*dq2*cos(q2))/2 + (Izz2*Izz3^2*dq1*dq3*cos(q2))/2 + Iyy3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2) + Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + Ixx3*Izz3^2*dq1^2*cos(q2)*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1^2*cos(q2)*sin(q2)*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2 - (Ixx3*Izz3^2*dq1*dq2*cos(q2)*sin(q3)^2)/2 - (Ixx3^2*Izz3*dq1*dq2*cos(q2)*sin(q3)^2)/2 + (Ixx3*Izz3^2*dq1*dq3*cos(q2)*sin(q3)^2)/2 + (Ixx3^2*Izz3*dq1*dq3*cos(q2)*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q3)^2)/2 - Ixx3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx3^2*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3)^3 - Iyy3^2*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q3)^2 - Ixx2*Izz2*Izz3*dq1^2*cos(q2)*sin(q2) + Iyy2*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2) - Iyy3*Izz2*Izz3*dq1^2*cos(q2)*sin(q2) + Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2) - (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 - (Iyy3^2*Izz3*dq2*dq3*cos(q2)*sin(q2))/2 - Izz2*Izz3^2*dq1*dq2*cos(q2)*sin(q2) - (Izz2*Izz3^2*dq1*dq3*cos(q2)*sin(q2))/2 + (Izz2*Izz3^2*dq2*dq3*cos(q2)*sin(q2))/2 - (Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2))/2 + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2))/2 - (Ixx3*Izz2*Izz3*dq1*dq2*cos(q2))/2 + (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2))/2 + (Iyy3*Izz2*Izz3*dq1*dq2*cos(q2))/2 - (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2))/2 - (Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 + (Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 - (Ixx3*Izz3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 - (Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) + (Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) - Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) + Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2) - (Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2 + Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 - Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2 - Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 + Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2 - Ixx3*Izz3^2*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 - (Ixx3*Izz3^2*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Ixx3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Ixx3*Izz3^2*dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Ixx3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - Ixx3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3)^3 - Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - Iyy3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3)^3 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q3)^2 - Ixx3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Iyy3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3)^3 + 2*Ixx3*Iyy3*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q3)^2 - Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) - Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) + Iyy3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3) + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2))/2 + Ixx2*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2) - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2) + (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + (Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)*sin(q2))/2 + Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2) - (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 - (Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)*sin(q2))/2 - Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Izz2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Izz2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + Iyy3*Izz2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2) + Iyy3*Izz2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)*sin(q3)^2 - Iyy2*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3)^3 + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Ixx3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Ixx3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3) - Ixx3*Izz2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3) + Iyy3*Izz2*Izz3*dq2*dq3*cos(q3)*sin(q2)*sin(q3) - Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) + Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2) - Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) + Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) - Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) + Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2) - 4*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (Ixx2*Izz3^2*dq1*dq2*cos(q2)^3)/2 + (Ixx2*Izz3^2*dq2*dq3*cos(q2)^3)/2 + (Izz1*Izz3^2*dq1*dq2*cos(q2))/2 + (Izz1*Izz3^2*dq2*dq3*cos(q2))/2 + Ixx2*Izz3^2*dq1*dq2*cos(q2)^3*sin(q2) - Ixx2^2*Izz3*dq1*dq2*cos(q2)^3*sin(q2) + (Iyy2*Izz3^2*dq1*dq2*cos(q2)*sin(q2)^2)/2 + Iyy2*Izz3^2*dq1*dq2*cos(q2)*sin(q2)^3 + Iyy2^2*Izz3*dq1*dq2*cos(q2)*sin(q2)^3 + (Iyy2*Izz3^2*dq2*dq3*cos(q2)*sin(q2)^2)/2 + Ixx3^2*Izz3*dq2^2*cos(q2)^2*cos(q3)^3*sin(q3) - Iyy3^2*Izz3*dq2^2*cos(q2)^2*cos(q3)*sin(q3)^3 + (Ixx3*Izz3^2*dq1*dq2*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2)/2 + (Ixx3*Izz3^2*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 + Ixx3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^4 + (Ixx3^2*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - Ixx3^2*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^4 + (Iyy3^2*Izz3*dq1*dq2*cos(q2)^3*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + Ixx3*Izz1*Izz3*dq2^2*cos(q3)*sin(q3) - Iyy3*Izz1*Izz3*dq2^2*cos(q3)*sin(q3) + Ixx3^2*Izz3*dq1^2*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq1^2*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Izz1*Izz3^2*dq1*dq2*cos(q2)*sin(q2) - (Ixx3*Izz1*Izz3*dq1*dq2*cos(q2))/2 + (Ixx3*Izz1*Izz3*dq2*dq3*cos(q2))/2 + (Iyy3*Izz1*Izz3*dq1*dq2*cos(q2))/2 - (Iyy3*Izz1*Izz3*dq2*dq3*cos(q2))/2 + (Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 + (Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 - (Ixx3*Izz3^2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 - (Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 + (Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3))/2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3))/2 + Ixx3*Izz1*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 - Ixx3*Izz1*Izz3*dq2*dq3*cos(q2)*cos(q3)^2 - Iyy3*Izz1*Izz3*dq1*dq2*cos(q2)*cos(q3)^2 + Iyy3*Izz1*Izz3*dq2*dq3*cos(q2)*cos(q3)^2 - Ixx2*Iyy2*Izz3*dq1*dq2*cos(q2)*sin(q2)^3 + Ixx2*Iyy2*Izz3*dq1*dq2*cos(q2)^3*sin(q2) + (Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^2)/2 - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^3 - (Iyy2*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 + Ixx3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq2^2*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx3*Iyy3*Izz3*dq2^2*cos(q2)^2*cos(q3)^3*sin(q3) + Ixx3*Izz3^2*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2) - Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^4*sin(q2) + Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)^3*sin(q3) + Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + (Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2)/2 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^4 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^4 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^3*sin(q2)*sin(q3)^2 - (Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*sin(q3)^2)/2 + (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 - 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^3*cos(q3)^2*sin(q3)^2 - Ixx2*Izz1*Izz3*dq1*dq2*cos(q2)*sin(q2) - Ixx3*Izz1*Izz3*dq2*dq3*cos(q3)*sin(q3) + Iyy2*Izz1*Izz3*dq1*dq2*cos(q2)*sin(q2) - Iyy3*Izz1*Izz3*dq1*dq2*cos(q2)*sin(q2) + Iyy3*Izz1*Izz3*dq2*dq3*cos(q3)*sin(q3) - Ixx3^2*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - Ixx3*Izz3^2*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy2*Iyy3*Izz3*dq2^2*cos(q3)*sin(q2)^2*sin(q3) + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q3)*sin(q2)^3*sin(q3) + Iyy2*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - 2*Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2) + 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^4*sin(q2) - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^3 + Iyy2*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)^3*sin(q2)*sin(q3)^2 - Ixx3*Izz1*Izz3*dq1*dq2*cos(q3)*sin(q2)*sin(q3) + Iyy3*Izz1*Izz3*dq1*dq2*cos(q3)*sin(q2)*sin(q3) - Ixx3^2*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Iyy2*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + (Ixx3*Izz3^2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (Ixx3*Izz3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - (Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Izz1*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) + Iyy3*Izz1*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + 3*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)
Iyy3^2*Izz3*dq1^2*cos(q2)*sin(q2)^2 - Izz2*Izz3^2*dq1^2*cos(q2)*sin(q2)^2 + (Iyy3^3*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 + (Iyy3^3*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 - (Iyy3^3*dq1*dq3*cos(q2)^3*sin(q3)^4)/2 - (Iyy3^3*dq2*dq3*cos(q2)^3*sin(q3)^4)/2 + (Iyy3^2*Izz1*dq1*dq3*cos(q2))/2 + (Iyy3^2*Izz1*dq2*dq3*cos(q2))/2 + Ixx2*Izz2*Izz3*dq1^2*cos(q2)*sin(q2)^2 - Iyy2*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)^2 + Iyy3*Izz2*Izz3*dq1^2*cos(q2)*sin(q2)^2 - Iyy3^3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Iyy3^3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Iyy3^3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^5 - Iyy3^3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^5 - Iyy3^2*Izz1*dq1*dq3*cos(q2)*cos(q3)^2 - Iyy3^2*Izz1*dq2*dq3*cos(q2)*cos(q3)^2 + (Iyy2*Iyy3^2*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3^2*Izz1*dq1*dq3*cos(q2)*sin(q3)^2)/2 + (Iyy2*Iyy3^2*dq2*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3^2*Izz1*dq2*dq3*cos(q2)*sin(q3)^2)/2 + Ixx3^2*Izz1*dq2*dq3*cos(q3)*sin(q3)^3 - (Iyy3^2*Izz1*dq1*dq3*cos(q2)*sin(q3)^2)/2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)^2 - (Iyy3^2*Izz1*dq2*dq3*cos(q2)*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 + (Iyy3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 + Iyy3^2*Izz1*dq2*dq3*cos(q3)*sin(q3)^3 + Izz2*Izz3^2*dq1*dq2*cos(q2)*sin(q2)^2 + (Izz2*Izz3^2*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Izz2*Izz3^2*dq2*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^3)/2 - (Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^3)/2 - (Ixx2*Ixx3*Izz2*dq1*dq3*cos(q2)^3)/2 - (Ixx2*Ixx3*Izz2*dq2*dq3*cos(q2)^3)/2 + (Ixx2*Iyy3*Izz2*dq1*dq3*cos(q2)^3)/2 + (Ixx2*Iyy3*Izz2*dq2*dq3*cos(q2)^3)/2 + (Ixx2*Izz2*Izz3*dq1*dq3*cos(q2)^3)/2 - (Ixx2*Izz2*Izz3*dq2*dq3*cos(q2)^3)/2 - Iyy3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2 - Ixx3*Izz3^2*dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 - (3*Iyy3^3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 - (3*Iyy3^3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 + Iyy3^3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 + Iyy3^3*dq1*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 + Iyy3^3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3)^3 - Iyy3^3*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3)^3 + Iyy3^3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 + Iyy3^3*dq2*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 + (Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 + (Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^4 + Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^4 - Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^4 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^4 - (Ixx3^2*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 + Ixx3^2*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^4 + Ixx3^2*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^4 - (Ixx2*Ixx3^2*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Ixx2*Ixx3^2*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 - (Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*sin(q3)^4 - (Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*sin(q3)^4)/2 + Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*sin(q3)^4 - (Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*sin(q3)^4)/2 + (Iyy3^2*Izz2*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 + (Iyy3^2*Izz2*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2)^3*sin(q3)^4)/2 + (Iyy3^2*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^4)/2 - (Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2))/2 + (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 - Iyy3^2*Izz1*dq2*dq3*cos(q3)*sin(q3) + (Izz2*Izz3^2*dq1*dq2*cos(q2)*sin(q2))/2 - (Izz2*Izz3^2*dq1*dq3*cos(q2)*sin(q2))/2 - (Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2))/2 - (Ixx3*Iyy3*Izz1*dq2*dq3*cos(q2))/2 - (Ixx3*Izz1*Izz2*dq1*dq3*cos(q2))/2 - (Ixx3*Izz1*Izz2*dq2*dq3*cos(q2))/2 + (Iyy3*Izz1*Izz3*dq1*dq3*cos(q2))/2 - (Iyy3*Izz1*Izz3*dq2*dq3*cos(q2))/2 + (Izz1*Izz2*Izz3*dq1*dq3*cos(q2))/2 - (Izz1*Izz2*Izz3*dq2*dq3*cos(q2))/2 + Iyy3^2*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)*cos(q3)^2 + Ixx3*Iyy3*Izz1*dq2*dq3*cos(q2)*cos(q3)^2 + Ixx3*Izz1*Izz2*dq1*dq3*cos(q2)*cos(q3)^2 + Ixx3*Izz1*Izz2*dq2*dq3*cos(q2)*cos(q3)^2 + (Ixx3*Izz3^2*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2)/2 + (Ixx3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2)/2 - (Ixx3*Izz3^2*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - (Ixx3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - Iyy2*Iyy3^2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) + (Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2)/2 - Iyy3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - (Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Iyy2*Izz2*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Iyy2*Izz2*dq2*dq3*cos(q2)*sin(q2)^2)/2 + Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz1*dq2*dq3*cos(q2)*sin(q3)^2 - (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 - 2*Ixx3*Iyy3*Izz1*dq2*dq3*cos(q3)*sin(q3)^3 - Ixx2*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2)^2 + (Iyy2*Iyy3*Izz2*dq1*dq3*cos(q2)*sin(q2)^2)/2 + Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^2 + (Ixx3*Izz1*Izz3*dq1*dq3*cos(q2)*sin(q3)^2)/2 - (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 + (Iyy2*Iyy3*Izz2*dq2*dq3*cos(q2)*sin(q2)^2)/2 + (Iyy2*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 - (Ixx3*Izz1*Izz3*dq2*dq3*cos(q2)*sin(q3)^2)/2 - (Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 - (Iyy2*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 - Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2)^2 - (Iyy3*Izz1*Izz3*dq1*dq3*cos(q2)*sin(q3)^2)/2 + (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2)/2 + (Iyy3*Izz1*Izz3*dq2*dq3*cos(q2)*sin(q3)^2)/2 + (Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2)/2 + Ixx3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + Ixx3^2*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + Iyy3^2*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Izz2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3*Izz2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 + Iyy2*Iyy3*Izz3*dq1^2*cos(q2)*sin(q2)^2*sin(q3)^2 + Ixx2*Ixx3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx2*Ixx3^2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx3*Iyy3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx3*Iyy3^2*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3*Iyy3^2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx3*Iyy3^2*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3) - Ixx3^2*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3) - 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^5 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^5 + 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^5 - Ixx3^2*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^5 - Iyy2*Iyy3^2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3^2*Izz1*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - Iyy2*Iyy3^2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Ixx3^2*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Ixx3^2*Izz1*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3^2*Izz2*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3^2*Izz2*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3) + Iyy3^2*Izz1*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3^2*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Iyy3^2*Izz1*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3^2*Izz2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + Iyy3^2*Izz2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2 + Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2 + Ixx2*Ixx3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2 + Ixx2*Ixx3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2 - Ixx2*Iyy3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2 - Ixx2*Iyy3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2 + (Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 + (Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 - Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^4 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^4 + (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2)/2 - (Ixx3^2*Iyy2*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Ixx3^2*Iyy2*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + Ixx3^2*Iyy2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx3*Izz3^2*dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 - (Iyy2*Iyy3^2*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + (Ixx3*Izz3^2*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Iyy2*Iyy3^2*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Ixx3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Ixx3*Izz3^2*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Ixx3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + Iyy2*Iyy3^2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 + Iyy3^2*Izz3*dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - (Iyy3^2*Izz3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + Iyy3^2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^3*sin(q3)^2 + Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^3*sin(q3)^2 - (Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^3*sin(q3)^4)/2 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^4)/2 + (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^3*sin(q3)^2)/2 - (Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)^3*sin(q3)^2)/2 + Ixx3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + Iyy3^2*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + (Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2))/2 - (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + Ixx3*Iyy3*Izz1*dq2*dq3*cos(q3)*sin(q3) + (Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2))/2 - (Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + Ixx3*Izz1*Izz2*dq2*dq3*cos(q3)*sin(q3) - (Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*sin(q2))/2 + (Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*sin(q2))/2 + Ixx2*Ixx3^2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Ixx2*Ixx3^2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - (Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 + 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - (Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 - 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 - 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 - 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3)^3 + Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 + Ixx3^2*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3)^3 + 2*Ixx3*Iyy3^2*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3)^3 - 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 - 2*Ixx3*Iyy3^2*dq2*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 - Ixx3^2*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3)^3 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^4 + Ixx3^2*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^4*sin(q3)^2 - Iyy3^2*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - Iyy3^2*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - (Iyy3^2*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 + (Iyy3^2*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 - Iyy3^2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)*sin(q3)^2 + Ixx3*Iyy2*Izz2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - Iyy2*Iyy3*Izz2*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) + Ixx3*Izz2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - Iyy3*Izz2*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - 2*Ixx3*Iyy3*Izz3*dq2^2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + Iyy2*Iyy3^2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Ixx3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Ixx3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 - Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - 2*Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 + 2*Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy2*Izz2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy2*Izz2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - 2*Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 + 2*Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - 2*Ixx3*Iyy3*Izz1*dq2*dq3*cos(q2)*cos(q3)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3)^3 - Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q3) - Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3)^3 + Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^4*cos(q3)^3*sin(q3) - Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy2*Iyy3*Izz2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy2*Iyy3*Izz2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Izz2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 - Iyy3*Izz2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2 + Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2 + Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2 - 2*Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q3)*sin(q2)^2*sin(q3)^3 - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)*sin(q2)^2*sin(q3)^2 - (Iyy2*Iyy3*Izz3*dq1*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 + (Iyy2*Iyy3*Izz3*dq2*dq3*cos(q2)*sin(q2)^2*sin(q3)^2)/2 - 2*Ixx3*Iyy3*Izz3*dq1^2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + Ixx3^2*Iyy2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Ixx3^2*Iyy2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx3^2*Iyy2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + Iyy2*Iyy3^2*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - 2*Ixx3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Iyy2*Iyy3^2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 + Iyy2*Iyy3^2*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)^2*sin(q3) + Ixx3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Ixx3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 + Ixx3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - 2*Iyy3^2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)^2*sin(q3) + Iyy3^2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 + Iyy3^2*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 - 2*Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 - 2*Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Ixx3*Iyy3*Izz2*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + Ixx3*Iyy3*Izz2*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2 + (Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 - (Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^3*cos(q3)^2*sin(q3)^2)/2 + Ixx3*Iyy3*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Ixx3*Izz2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Iyy3*Izz2*Izz3*dq1^2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + (Ixx3*Izz3^2*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (Ixx3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + (Ixx3*Izz3^2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + (Ixx3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 - (Iyy3^2*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + Iyy3^2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + (Iyy3^2*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3))/2 + Ixx2*Ixx3*Iyy3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx2*Ixx3*Iyy3*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3) + Ixx2*Ixx3*Izz2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx2*Ixx3*Izz2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz1*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Ixx2*Iyy3*Izz2*dq2*dq3*cos(q2)^2*cos(q3)*sin(q3) + Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Ixx2*Iyy3*Izz2*dq1*dq3*cos(q2)^4*cos(q3)*sin(q3) - Ixx3*Izz1*Izz2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - Ixx3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) + Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) + Iyy3*Izz2*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2) - Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Ixx3*Iyy2*Izz2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)^3 + 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)^3*sin(q2)*sin(q3) + Iyy2*Iyy3*Izz2*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Iyy2*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) + Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + 2*Ixx3*Iyy2*Iyy3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 - 2*Ixx3*Iyy2*Iyy3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + 4*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)^3*sin(q2)^2*sin(q3) - 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + 2*Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)^2*sin(q3)^3 - 2*Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)*cos(q3)^2*sin(q2)^2*sin(q3)^2 + Ixx3*Iyy3*Izz3*dq1*dq2*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Ixx3*Iyy3*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Ixx3*Iyy3*Izz3*dq2*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) - Ixx3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3) + Iyy3*Izz2*Izz3*dq1*dq3*cos(q2)^2*cos(q3)*sin(q2)*sin(q3)
 

%%
% syms a b c d e f g
a=72;
b=84;
c=294;
d=24;
e=70;
f=5*3*7;
g=84;
Iy3=(c*a^2/b^2)^(1/3);
Ix2=a/Iy3^2;
Iz3=(b/a)*Iy3;
Ix3=e/(Ix2*Iz3);
Iy2=f/(Ix3*Iz3);
Iz2=g/(Iz3*Iy2);
Iz1=d/(Iy3*Iz2);
% q1=-72+b*f^2;
% q2=-84+b*g*f;
% q3=294-f*g^2;
% q4=24-a*d*f;
% q5=2*3*7-b*c*g;
% q6=5*3*7-c*e*g;
% q7=12*7-c*d*g;

% solve([q1,q2,q3,q4,q5,q6,q7],[a,b,c,d,e,f,g])


% solve([q1,q2,q3],[b,f,g])


%%
Izz1=0.192;
Ixx3=0.063; Iyy3=0.061; Izz3= 0.02;
Ixx2=0.0027; Iyy2=0.0024; Izz2=0.0004;

TETA=[Ixx2*Iyy3^2
     Ixx2*Iyy3*Izz3
     Iyy3*Izz3^2
     Iyy3*Izz1*Izz2
     Ixx2*Ixx3*Izz3
     Ixx3*Iyy2*Izz3
     Iyy2*Izz2*Izz3];



Iyy3=(TETA(3)*TETA(1)^2/TETA(2)^2)^(1/3);
Ixx2=TETA(1)/Iyy3^2;
Izz3=(TETA(2)/TETA(1))*Iyy3;
Ixx3=TETA(5)/(Ixx2*Izz3);
Iyy2=TETA(6)/(Ixx3*Izz3);
Izz2=TETA(7)/(Izz3*Iyy2);
Izz1=TETA(4)/(Iyy3*Izz2);